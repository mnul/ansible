---

- hosts: all
  become: true
  tasks:

  - name: update cache
    apt:
      update_cache: yes
      cache_valid_time: 3600

  
  - name: full upgrade
    apt:
      upgrade: full

  - name: autoremove
    apt:
      autoremove: yes
    
  - name: clean apt cache
    apt:
      autoclean: yes
    
  - name: copy ansible-vault-password
    copy:
      dest: /root/.ansible-vault-password
      owner: root
      group: root
      mode: 0600
      content: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          30383631303564636364373634313564373661393237316537663134356436656537363432656161
          3362346261316562666631633033623131633237323038610a363266336139666132353463386334
          63303465623730353733353865363963323837646464636137356331613031343064366231333533
          3434303465326133330a643839323438306133633663623134623965306639356535356466616132
          66323933363364633336626437613133613935306438363132363233333338623262
          
        
  - name: install pip3, python3-setuptools, git
    apt:
      name: 
        - python3-setuptools
        - python3-pip
        - git
      state: present
      update_cache: yes
      cache_valid_time: 3600
      
  - name: Install Ansible using pip
    ansible.builtin.pip:
      name: ansible
      state: latest
